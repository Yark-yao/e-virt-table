<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tree Selection - 高级示例</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            margin: 20px;
            background-color: #f5f5f5;
            min-height: 100vh;
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            overflow: hidden;
        }
        .header {
            background: #2c3e50;
            color: white;
            padding: 20px;
            text-align: center;
        }
        .content {
            padding: 20px;
        }
        .controls {
            margin-bottom: 20px;
            padding: 15px;
            background: #f8f9fa;
            border-radius: 6px;
            border: 1px solid #e9ecef;
        }
        .controls button {
            margin-right: 10px;
            padding: 8px 16px;
            border: 1px solid #007bff;
            background: #007bff;
            color: white;
            border-radius: 4px;
            cursor: pointer;
            font-size: 14px;
        }
        .controls button:hover {
            background: #0056b3;
        }
        .controls select {
            padding: 8px;
            border: 1px solid #ced4da;
            border-radius: 4px;
            margin-right: 10px;
        }
        .controls label {
            margin-left: 10px;
            font-size: 14px;
        }
        .table-container {
            border: 1px solid #dee2e6;
            border-radius: 6px;
            overflow: hidden;
        }
        .info {
            margin-top: 20px;
            padding: 15px;
            background: #e7f3ff;
            border: 1px solid #b3d9ff;
            border-radius: 6px;
            min-height: auto;
            overflow: visible;
            height: auto;
            max-height: none;
        }
        .info h3 {
            margin-top: 0;
            color: #0056b3;
        }
        .info ul {
            margin: 10px 0;
            padding-left: 20px;
        }
        .info li {
            margin: 5px 0;
        }
        .mode-description {
            margin-bottom: 20px;
            padding: 15px;
            background: #f8f9fa;
            border: 1px solid #e9ecef;
            border-radius: 6px;
        }
        .mode-description h3 {
            margin-top: 0;
            color: #495057;
            font-size: 16px;
        }
        .mode-description ul {
            margin: 10px 0;
            padding-left: 20px;
        }
        .mode-description li {
            margin: 8px 0;
            line-height: 1.5;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>Tree Selection - 高级示例</h1>
            <p>支持三种选择模式：Auto、Cautious、Strictly</p>
        </div>
        
        <div class="content">
            <div class="mode-description">
                <h3>模式说明：</h3>
                <ul>
                    <li><strong>Auto模式</strong>：常见的树形勾选模式，子项全不选→父项不勾选，子项全选→父项勾选，子项都有→父项半选，半选算在最终选择的数据里面</li>
                    <li><strong>Cautious模式</strong>：交互上相同，但是半选是不算在数据里面的</li>
                    <li><strong>Strictly模式</strong>：父子各选各的互相不干扰，没有半选模式</li>
                </ul>
            </div>
            
            <div class="controls">
                <button id="tree-select-all">全选</button>
                <button id="tree-unselect-all">取消全选</button>
                <button id="tree-expand-all">展开全部</button>
                <button id="tree-collapse-all">收起全部</button>
                <button id="tree-get-selected">获取选中</button>
                
                <select id="tree-select-mode">
                    <option value="auto">Auto模式</option>
                    <option value="cautious">Cautious模式</option>
                    <option value="strictly">Strictly模式</option>
                </select>
                
                <label>
                    <input type="checkbox" id="tree-auto-fit-width"> 自动调整列宽
                </label>
            </div>
            
            <div class="table-container">
                <div id="tree-table"></div>
            </div>
        </div>
    </div>

    <script type="module">
        import EVirtTable from '../../src/index.js';

        // 树形数据
        const treeData = [
            {
                id: '1',
                name: '技术部',
                _hasChildren: true,
                children: [
                    {
                        id: '1-1',
                        name: '前端组',
                        _hasChildren: true,
                        children: [
                            {
                                id: '1-1-1',
                                name: 'React团队',
                                _hasChildren: true,
                                children: [
                                    {
                                        id: '1-1-1-1',
                                        name: '组件库组',
                                        _hasChildren: true,
                                        children: [
                                            { id: '1-1-1-1-1', name: '张三', role: 'React工程师' },
                                            { id: '1-1-1-1-2', name: '李四', role: 'React工程师' }
                                        ]
                                    },
                                    {
                                        id: '1-1-1-2',
                                        name: '状态管理组',
                                        _hasChildren: true,
                                        children: [
                                            { id: '1-1-1-2-1', name: '王五', role: '状态管理工程师' },
                                            { id: '1-1-1-2-2', name: '赵六', role: '状态管理工程师' }
                                        ]
                                    }
                                ]
                            },
                            {
                                id: '1-1-2',
                                name: 'Vue团队',
                                _hasChildren: true,
                                children: [
                                    {
                                        id: '1-1-2-1',
                                        name: 'Vue3开发组',
                                        _hasChildren: true,
                                        children: [
                                            { id: '1-1-2-1-1', name: '孙七', role: 'Vue工程师' },
                                            { id: '1-1-2-1-2', name: '周八', role: 'Vue工程师' }
                                        ]
                                    }
                                ]
                            },
                            {
                                id: '1-1-3',
                                name: '工具链组',
                                _hasChildren: true,
                                children: [
                                    { id: '1-1-3-1', name: '吴九', role: '工具链工程师' },
                                    { id: '1-1-3-2', name: '郑十', role: '工具链工程师' }
                                ]
                            }
                        ]
                    },
                    {
                        id: '1-2',
                        name: '后端组',
                        _hasChildren: true,
                        children: [
                            {
                                id: '1-2-1',
                                name: 'Java团队',
                                _hasChildren: true,
                                children: [
                                    {
                                        id: '1-2-1-1',
                                        name: '微服务组',
                                        _hasChildren: true,
                                        children: [
                                            { id: '1-2-1-1-1', name: '陈十一', role: 'Java工程师' },
                                            { id: '1-2-1-1-2', name: '杨十二', role: 'Java工程师' }
                                        ]
                                    }
                                ]
                            },
                            {
                                id: '1-2-2',
                                name: 'Go团队',
                                _hasChildren: true,
                                children: [
                                    { id: '1-2-2-1', name: '黄十三', role: 'Go工程师' },
                                    { id: '1-2-2-2', name: '刘十四', role: 'Go工程师' }
                                ]
                            }
                        ]
                    },
                    {
                        id: '1-3',
                        name: '测试组',
                        _hasChildren: true,
                        children: [
                            {
                                id: '1-3-1',
                                name: '自动化测试组',
                                _hasChildren: true,
                                children: [
                                    { id: '1-3-1-1', name: '周十五', role: '自动化测试工程师' },
                                    { id: '1-3-1-2', name: '吴十六', role: '自动化测试工程师' }
                                ]
                            },
                            {
                                id: '1-3-2',
                                name: '性能测试组',
                                _hasChildren: true,
                                children: [
                                    { id: '1-3-2-1', name: '郑十七', role: '性能测试工程师' },
                                    { id: '1-3-2-2', name: '王十八', role: '性能测试工程师' }
                                ]
                            }
                        ]
                    }
                ]
            },
            {
                id: '2',
                name: '产品部',
                _hasChildren: true,
                children: [
                    {
                        id: '2-1',
                        name: '产品组',
                        _hasChildren: true,
                        children: [
                            { id: '2-1-1', name: '产品经理A', role: '产品经理' },
                            { id: '2-1-2', name: '产品经理B', role: '产品经理' }
                        ]
                    },
                    {
                        id: '2-2',
                        name: '设计组',
                        _hasChildren: true,
                        children: [
                            { id: '2-2-1', name: 'UI设计师A', role: 'UI设计师' },
                            { id: '2-2-2', name: 'UI设计师B', role: 'UI设计师' }
                        ]
                    }
                ]
            },
            {
                id: '3',
                name: '运营部',
                _hasChildren: true,
                children: [
                    {
                        id: '3-1',
                        name: '市场组',
                        _hasChildren: true,
                        children: [
                            { id: '3-1-1', name: '市场专员A', role: '市场专员' },
                            { id: '3-1-2', name: '市场专员B', role: '市场专员' }
                        ]
                    }
                ]
            }
        ];

        // 树形选择列配置
        const treeColumns = [
            {
                title: '选择',
                type: 'tree-selection',
                key: 'selection',
                width: 60,
                widthFillDisable: true,
                readonly: true,
                fixed: 'left'
            },
            {
                title: 'ID',
                key: 'id',
                width: 100,
                readonly: true,
                fixed: 'left'
            },
            {
                title: '姓名',
                key: 'name',
                width: 150,
                readonly: true
            },
            {
                title: '职位',
                key: 'role',
                width: 200,
                readonly: true
            }
        ];

        // 创建树形选择表格
        const treeTable = new EVirtTable(document.getElementById('tree-table'), {
            columns: treeColumns,
            data: treeData,
            config: {
                TREE_SELECT_MODE: 'auto', // auto | cautious | strictly
                ROW_KEY: 'id',
                ENABLE_SELECTOR: true,
                ENABLE_KEYBOARD: true,
                ENABLE_HISTORY: true,
                CELL_HEIGHT: 36,
                BORDER: true,
                STRIPE: false,
                HIGHLIGHT_HOVER_ROW: true,
                DEFAULT_EXPAND_ALL: true,
                ENABLE_CONTEXT_MENU: true,
                AUTO_FIT_TREE_WIDTH: false, // 自动调整树形列宽度
                CONTEXT_MENU: [
                    { label: '全选', value: 'selectAll' },
                    { label: '取消全选', value: 'unselectAll' },
                    { label: '展开全部', value: 'expandAll' },
                    { label: '收起全部', value: 'collapseAll' }
                ]
            }
        });

        // 绑定按钮事件
        document.getElementById('tree-select-all').addEventListener('click', () => {
            treeTable.toggleAllSelection();
        });

        document.getElementById('tree-unselect-all').addEventListener('click', () => {
            treeTable.clearSelection();
        });

        document.getElementById('tree-expand-all').addEventListener('click', () => {
            treeTable.toggleExpandAll(true);
        });

        document.getElementById('tree-collapse-all').addEventListener('click', () => {
            treeTable.toggleExpandAll(false);
        });

        document.getElementById('tree-get-selected').addEventListener('click', () => {
            const selectedRows = treeTable.getSelectionRows();
            alert(`选中了 ${selectedRows.length} 行数据`);
        });

        // 监听选择模式变化
        document.getElementById('tree-select-mode').addEventListener('change', (event) => {
            const mode = event.target.value;
            treeTable.loadConfig({
                TREE_SELECT_MODE: mode
            });
        });
        
        // 自动调整列宽控制
        document.getElementById('tree-auto-fit-width').addEventListener('change', (event) => {
            const autoFitWidth = event.target.checked;
            treeTable.loadConfig({
                AUTO_FIT_TREE_WIDTH: autoFitWidth
            });
            treeTable.loadColumns(treeColumns);
        });

        // 添加右键菜单事件处理
        treeTable.on('contextMenuClick', (menuItem) => {
            switch (menuItem.value) {
                case 'selectAll':
                    treeTable.toggleAllSelection();
                    break;
                case 'unselectAll':
                    treeTable.clearSelection();
                    break;
                case 'expandAll':
                    treeTable.toggleExpandAll(true);
                    break;
                case 'collapseAll':
                    treeTable.toggleExpandAll(false);
                    break;
            }
        });
    </script>
</body>
</html> 